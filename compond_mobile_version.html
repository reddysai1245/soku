<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Compound Interest Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Inter', sans-serif; }
    </style>
</head>
<body class="bg-gradient-to-br from-blue-50 to-indigo-100 min-h-screen">
    <div class="container mx-auto px-4 py-8">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">Compound Interest Manager</h1>
            <p class="text-gray-600">Track your lending and borrowing with automated compound interest calculations</p>
        </div>

        <!-- Navigation Tabs -->
        <div class="flex justify-center mb-8">
            <div class="bg-white rounded-lg shadow-md p-1 flex">
                <button onclick="showSection('receivables')" id="receivables-tab" class="px-6 py-3 rounded-md font-medium transition-all duration-200 bg-blue-600 text-white">
                    Money to Receive
                </button>
                <button onclick="showSection('payables')" id="payables-tab" class="px-6 py-3 rounded-md font-medium transition-all duration-200 text-gray-600 hover:text-blue-600">
                    Money to Pay
                </button>
                <button onclick="showSection('dashboard')" id="dashboard-tab" class="px-6 py-3 rounded-md font-medium transition-all duration-200 text-gray-600 hover:text-blue-600">
                    Dashboard
                </button>
            </div>
        </div>

        <!-- Money to Receive Section -->
        <div id="receivables-section" class="section">
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-semibold text-green-700 mb-4 flex items-center">
                    <span class="bg-green-100 p-2 rounded-lg mr-3">💰</span>
                    Money to Receive
                </h2>
                
                <!-- Add New Entry Form -->
                <div class="bg-green-50 rounded-lg p-4 mb-6">
                    <h3 class="font-medium text-green-800 mb-3">Add New Entry</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <input type="text" id="receivable-name" placeholder="Person/Entity Name" class="px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                        <input type="number" id="receivable-principal" placeholder="Principal Amount (₹)" class="px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                        <input type="number" id="receivable-rate" placeholder="Monthly Rate (e.g., 1.25)" step="0.01" class="px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                    </div>
                    
                    <!-- Duration Selection -->
                    <div class="mb-4">
                        <label class="block text-green-800 font-medium mb-2">Duration Method:</label>
                        <div class="flex gap-4 mb-3">
                            <label class="flex items-center">
                                <input type="radio" name="receivable-duration-type" value="date" checked onchange="toggleReceivableDuration()" class="mr-2">
                                <span class="text-green-700">By Date Range</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="receivable-duration-type" value="duration" onchange="toggleReceivableDuration()" class="mr-2">
                                <span class="text-green-700">By Duration</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="receivable-duration-type" value="fromstart" onchange="toggleReceivableDuration()" class="mr-2">
                                <span class="text-green-700">From Start to Today</span>
                            </label>
                        </div>
                        
                        <!-- Date Input -->
                        <div id="receivable-date-input" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <input type="date" id="receivable-start-date" placeholder="Start Date" class="px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                            <input type="date" id="receivable-end-date" placeholder="End Date" class="px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        
                        <!-- Duration Input -->
                        <div id="receivable-duration-input" class="hidden grid grid-cols-1 md:grid-cols-3 gap-4">
                            <input type="number" id="receivable-years" placeholder="Years" min="0" class="px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                            <input type="number" id="receivable-months" placeholder="Months" min="0" max="11" class="px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                            <input type="number" id="receivable-days" placeholder="Days" min="0" max="30" class="px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                        
                        <!-- From Start Input -->
                        <div id="receivable-fromstart-input" class="hidden">
                            <input type="date" id="receivable-from-start-date" placeholder="Start Date" class="px-3 py-2 border border-green-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500">
                        </div>
                    </div>
                    
                    <button onclick="addReceivable()" class="bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 transition-colors">
                        Add Entry
                    </button>
                </div>

                <!-- Receivables Table -->
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-green-100">
                                <th class="border border-green-300 px-4 py-3 text-left font-semibold text-green-800">Name</th>
                                <th class="border border-green-300 px-4 py-3 text-right font-semibold text-green-800">Principal (₹)</th>
                                <th class="border border-green-300 px-4 py-3 text-center font-semibold text-green-800">Start Date</th>
                                <th class="border border-green-300 px-4 py-3 text-center font-semibold text-green-800">End Date</th>
                                <th class="border border-green-300 px-4 py-3 text-center font-semibold text-green-800">Duration</th>
                                <th class="border border-green-300 px-4 py-3 text-right font-semibold text-green-800">Interest (₹)</th>
                                <th class="border border-green-300 px-4 py-3 text-right font-semibold text-green-800">Total (₹)</th>
                                <th class="border border-green-300 px-4 py-3 text-center font-semibold text-green-800">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="receivables-table">
                            <!-- Dynamic content will be added here -->
                        </tbody>
                        <tfoot>
                            <tr class="bg-green-200 font-bold">
                                <td class="border border-green-300 px-4 py-3 text-green-800">TOTAL</td>
                                <td class="border border-green-300 px-4 py-3 text-right text-green-800" id="receivables-principal-total">₹0</td>
                                <td class="border border-green-300 px-4 py-3"></td>
                                <td class="border border-green-300 px-4 py-3"></td>
                                <td class="border border-green-300 px-4 py-3"></td>
                                <td class="border border-green-300 px-4 py-3 text-right text-green-800" id="receivables-interest-till-date-total">₹0</td>
                                <td class="border border-green-300 px-4 py-3 text-right text-green-800" id="receivables-total-total">₹0</td>
                                <td class="border border-green-300 px-4 py-3"></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>

        <!-- Money to Pay Section -->
        <div id="payables-section" class="section hidden">
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-2xl font-semibold text-red-700 mb-4 flex items-center">
                    <span class="bg-red-100 p-2 rounded-lg mr-3">💸</span>
                    Money to Pay
                </h2>
                
                <!-- Add New Entry Form -->
                <div class="bg-red-50 rounded-lg p-4 mb-6">
                    <h3 class="font-medium text-red-800 mb-3">Add New Entry</h3>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
                        <input type="text" id="payable-name" placeholder="Person/Entity Name" class="px-3 py-2 border border-red-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                        <input type="number" id="payable-principal" placeholder="Principal Amount (₹)" class="px-3 py-2 border border-red-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                        <input type="number" id="payable-rate" placeholder="Monthly Rate (e.g., 1.25)" step="0.01" class="px-3 py-2 border border-red-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                    </div>
                    
                    <!-- Duration Selection -->
                    <div class="mb-4">
                        <label class="block text-red-800 font-medium mb-2">Duration Method:</label>
                        <div class="flex gap-4 mb-3">
                            <label class="flex items-center">
                                <input type="radio" name="payable-duration-type" value="date" checked onchange="togglePayableDuration()" class="mr-2">
                                <span class="text-red-700">By Date Range</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="payable-duration-type" value="duration" onchange="togglePayableDuration()" class="mr-2">
                                <span class="text-red-700">By Duration</span>
                            </label>
                            <label class="flex items-center">
                                <input type="radio" name="payable-duration-type" value="fromstart" onchange="togglePayableDuration()" class="mr-2">
                                <span class="text-red-700">From Start to Today</span>
                            </label>
                        </div>
                        
                        <!-- Date Input -->
                        <div id="payable-date-input" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <input type="date" id="payable-start-date" placeholder="Start Date" class="px-3 py-2 border border-red-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                            <input type="date" id="payable-end-date" placeholder="End Date" class="px-3 py-2 border border-red-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                        </div>
                        
                        <!-- Duration Input -->
                        <div id="payable-duration-input" class="hidden grid grid-cols-1 md:grid-cols-3 gap-4">
                            <input type="number" id="payable-years" placeholder="Years" min="0" class="px-3 py-2 border border-red-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                            <input type="number" id="payable-months" placeholder="Months" min="0" max="11" class="px-3 py-2 border border-red-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                            <input type="number" id="payable-days" placeholder="Days" min="0" max="30" class="px-3 py-2 border border-red-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                        </div>
                        
                        <!-- From Start Input -->
                        <div id="payable-fromstart-input" class="hidden">
                            <input type="date" id="payable-from-start-date" placeholder="Start Date" class="px-3 py-2 border border-red-300 rounded-md focus:outline-none focus:ring-2 focus:ring-red-500">
                        </div>
                    </div>
                    
                    <button onclick="addPayable()" class="bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 transition-colors">
                        Add Entry
                    </button>
                </div>

                <!-- Payables Table -->
                <div class="overflow-x-auto">
                    <table class="w-full border-collapse">
                        <thead>
                            <tr class="bg-red-100">
                                <th class="border border-red-300 px-4 py-3 text-left font-semibold text-red-800">Name</th>
                                <th class="border border-red-300 px-4 py-3 text-right font-semibold text-red-800">Principal (₹)</th>
                                <th class="border border-red-300 px-4 py-3 text-center font-semibold text-red-800">Start Date</th>
                                <th class="border border-red-300 px-4 py-3 text-center font-semibold text-red-800">End Date</th>
                                <th class="border border-red-300 px-4 py-3 text-center font-semibold text-red-800">Duration</th>
                                <th class="border border-red-300 px-4 py-3 text-right font-semibold text-red-800">Interest (₹)</th>
                                <th class="border border-red-300 px-4 py-3 text-right font-semibold text-red-800">Total (₹)</th>
                                <th class="border border-red-300 px-4 py-3 text-center font-semibold text-red-800">Actions</th>
                            </tr>
                        </thead>
                        <tbody id="payables-table">
                            <!-- Dynamic content will be added here -->
                        </tbody>
                        <tfoot>
                            <tr class="bg-red-200 font-bold">
                                <td class="border border-red-300 px-4 py-3 text-red-800">TOTAL</td>
                                <td class="border border-red-300 px-4 py-3 text-right text-red-800" id="payables-principal-total">₹0</td>
                                <td class="border border-red-300 px-4 py-3"></td>
                                <td class="border border-red-300 px-4 py-3"></td>
                                <td class="border border-red-300 px-4 py-3"></td>
                                <td class="border border-red-300 px-4 py-3 text-right text-red-800" id="payables-interest-till-date-total">₹0</td>
                                <td class="border border-red-300 px-4 py-3 text-right text-red-800" id="payables-total-total">₹0</td>
                                <td class="border border-red-300 px-4 py-3"></td>
                            </tr>
                        </tfoot>
                    </table>
                </div>
            </div>
        </div>

        <!-- Dashboard Section -->
        <div id="dashboard-section" class="section hidden">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6">
                <!-- Summary Cards -->
                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <span class="bg-green-100 p-2 rounded-lg mr-3">📈</span>
                        Money to Receive Summary
                    </h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Total Principal:</span>
                            <span class="font-semibold text-green-600" id="dashboard-receivables-principal">₹0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Total Interest:</span>
                            <span class="font-semibold text-green-600" id="dashboard-receivables-interest">₹0</span>
                        </div>
                        <div class="flex justify-between border-t pt-2">
                            <span class="text-gray-800 font-medium">Total Amount:</span>
                            <span class="font-bold text-green-700" id="dashboard-receivables-total">₹0</span>
                        </div>
                    </div>
                </div>

                <div class="bg-white rounded-xl shadow-lg p-6">
                    <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                        <span class="bg-red-100 p-2 rounded-lg mr-3">📉</span>
                        Money to Pay Summary
                    </h3>
                    <div class="space-y-3">
                        <div class="flex justify-between">
                            <span class="text-gray-600">Total Principal:</span>
                            <span class="font-semibold text-red-600" id="dashboard-payables-principal">₹0</span>
                        </div>
                        <div class="flex justify-between">
                            <span class="text-gray-600">Total Interest:</span>
                            <span class="font-semibold text-red-600" id="dashboard-payables-interest">₹0</span>
                        </div>
                        <div class="flex justify-between border-t pt-2">
                            <span class="text-gray-800 font-medium">Total Amount:</span>
                            <span class="font-bold text-red-700" id="dashboard-payables-total">₹0</span>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Net Position -->
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h3 class="text-xl font-semibold text-gray-800 mb-4 flex items-center">
                    <span class="bg-blue-100 p-2 rounded-lg mr-3">⚖️</span>
                    Net Financial Position
                </h3>
                <div class="text-center">
                    <div class="text-3xl font-bold mb-2" id="net-position">₹0</div>
                    <div class="text-gray-600" id="net-position-text">Balanced Position</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Data storage
        let receivables = [];
        let payables = [];

        // Show/hide sections
        function showSection(section) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(s => s.classList.add('hidden'));
            
            // Remove active class from all tabs
            document.querySelectorAll('[id$="-tab"]').forEach(tab => {
                tab.classList.remove('bg-blue-600', 'text-white');
                tab.classList.add('text-gray-600');
            });
            
            // Show selected section
            document.getElementById(section + '-section').classList.remove('hidden');
            
            // Activate selected tab
            const activeTab = document.getElementById(section + '-tab');
            activeTab.classList.add('bg-blue-600', 'text-white');
            activeTab.classList.remove('text-gray-600');

            if (section === 'dashboard') {
                updateDashboard();
            }
        }

        // Toggle duration input methods
        function toggleReceivableDuration() {
            const durationType = document.querySelector('input[name="receivable-duration-type"]:checked').value;
            const dateInput = document.getElementById('receivable-date-input');
            const durationInput = document.getElementById('receivable-duration-input');
            const fromStartInput = document.getElementById('receivable-fromstart-input');
            
            // Hide all inputs first
            dateInput.classList.add('hidden');
            durationInput.classList.add('hidden');
            fromStartInput.classList.add('hidden');
            
            // Show the selected input
            if (durationType === 'date') {
                dateInput.classList.remove('hidden');
            } else if (durationType === 'duration') {
                durationInput.classList.remove('hidden');
            } else if (durationType === 'fromstart') {
                fromStartInput.classList.remove('hidden');
            }
        }

        function togglePayableDuration() {
            const durationType = document.querySelector('input[name="payable-duration-type"]:checked').value;
            const dateInput = document.getElementById('payable-date-input');
            const durationInput = document.getElementById('payable-duration-input');
            const fromStartInput = document.getElementById('payable-fromstart-input');
            
            // Hide all inputs first
            dateInput.classList.add('hidden');
            durationInput.classList.add('hidden');
            fromStartInput.classList.add('hidden');
            
            // Show the selected input
            if (durationType === 'date') {
                dateInput.classList.remove('hidden');
            } else if (durationType === 'duration') {
                durationInput.classList.remove('hidden');
            } else if (durationType === 'fromstart') {
                fromStartInput.classList.remove('hidden');
            }
        }

        // Helper function to format duration display
        function formatDuration(startDate, endDate = null, years = 0, months = 0, days = 0) {
            if (endDate) {
                // Calculate duration from dates
                const start = new Date(startDate);
                const end = new Date(endDate);
                const startYear = start.getFullYear();
                const startMonth = start.getMonth();
                const startDay = start.getDate();
                const endYear = end.getFullYear();
                const endMonth = end.getMonth();
                const endDay = end.getDate();
                
                let yearsDiff = endYear - startYear;
                let monthsDiff = endMonth - startMonth;
                let daysDiff = endDay - startDay;
                
                if (daysDiff < 0) {
                    monthsDiff--;
                    daysDiff += 30;
                }
                
                if (monthsDiff < 0) {
                    yearsDiff--;
                    monthsDiff += 12;
                }
                
                let parts = [];
                if (yearsDiff > 0) parts.push(`${yearsDiff}Y`);
                if (monthsDiff > 0) parts.push(`${monthsDiff}M`);
                if (daysDiff > 0) parts.push(`${daysDiff}D`);
                
                return parts.length > 0 ? parts.join(' ') : '0D';
            } else {
                // Format from duration values
                let parts = [];
                if (years > 0) parts.push(`${years}Y`);
                if (months > 0) parts.push(`${months}M`);
                if (days > 0) parts.push(`${days}D`);
                
                return parts.length > 0 ? parts.join(' ') : '0D';
            }
        }

        // Calculate compound interest with flexible duration input
        // Rate is monthly: 1.25 means ₹1.25 per ₹100 per month (fixed rate per 100)
        // ₹100,000 at 1.25 rate = ₹1,250 interest per month (100,000/100 * 1.25)
        // Compounds annually: Interest is added to principal at year end
        // Using exactly 360 days per year and 30 days per month
        function calculateCompoundInterest(principal, monthlyRate, startDate, endDate = null, years = 0, months = 0, days = 0) {
            const start = new Date(startDate);
            let totalDays;
            
            if (endDate) {
                // For date range, use exact 360-day system calculation
                const end = new Date(endDate);
                const startYear = start.getFullYear();
                const startMonth = start.getMonth();
                const startDay = start.getDate();
                const endYear = end.getFullYear();
                const endMonth = end.getMonth();
                const endDay = end.getDate();
                
                // Calculate years, months, and days in 360-day system
                let yearsDiff = endYear - startYear;
                let monthsDiff = endMonth - startMonth;
                let daysDiff = endDay - startDay;
                
                // Adjust for negative days
                if (daysDiff < 0) {
                    monthsDiff--;
                    daysDiff += 30; // Always use 30 days per month
                }
                
                // Adjust for negative months
                if (monthsDiff < 0) {
                    yearsDiff--;
                    monthsDiff += 12;
                }
                
                // Convert to total days using 360-day system
                totalDays = (yearsDiff * 360) + (monthsDiff * 30) + daysDiff;
            } else {
                // Calculate from duration using exact 360-day year system
                totalDays = (years * 360) + (months * 30) + days;
            }
            
            if (totalDays <= 0) return { interest: (principal / 100) * monthlyRate, interestTillDate: 0, total: principal };
            
            // Using exact 360-day year system: 1 year = 360 days = 12 months of 30 days each
            const completeYears = Math.floor(totalDays / 360);
            const remainingDays = totalDays % 360;
            const remainingMonths = Math.floor(remainingDays / 30);
            const finalDays = remainingDays % 30;
            
            let currentPrincipal = principal;
            let totalInterest = 0;
            
            // Calculate interest for complete years (compound annually)
            for (let year = 0; year < completeYears; year++) {
                // Calculate monthly interest: (principal / 100) * rate
                const monthlyInterestAmount = (currentPrincipal / 100) * monthlyRate;
                // Simple interest for exactly 12 months within the year
                const yearlyInterest = monthlyInterestAmount * 12;
                totalInterest += yearlyInterest;
                // Compound: Add interest to principal for next year
                currentPrincipal += yearlyInterest;
            }
            
            // Calculate interest for remaining months (based on current principal after complete years)
            if (remainingMonths > 0) {
                const monthlyInterestAmount = (currentPrincipal / 100) * monthlyRate;
                const remainingMonthsInterest = monthlyInterestAmount * remainingMonths;
                totalInterest += remainingMonthsInterest;
            }
            
            // Calculate interest for remaining days (proportional to monthly rate based on current principal)
            if (finalDays > 0) {
                const monthlyInterestAmount = (currentPrincipal / 100) * monthlyRate;
                const dailyInterest = monthlyInterestAmount / 30;
                totalInterest += dailyInterest * finalDays;
            }
            
            const finalAmount = principal + totalInterest;
            
            return {
                interest: (principal / 100) * monthlyRate, // Monthly interest amount for original principal (for display)
                interestTillDate: totalInterest,
                total: finalAmount
            };
        }

        // Add receivable entry
        function addReceivable() {
            const name = document.getElementById('receivable-name').value;
            const principal = parseFloat(document.getElementById('receivable-principal').value);
            const rate = parseFloat(document.getElementById('receivable-rate').value);
            const durationType = document.querySelector('input[name="receivable-duration-type"]:checked').value;

            if (!name || !principal || !rate) {
                alert('Please fill all required fields');
                return;
            }

            let entry = {
                id: Date.now(),
                name,
                principal,
                rate,
                durationType
            };

            if (durationType === 'date') {
                const startDate = document.getElementById('receivable-start-date').value;
                const endDate = document.getElementById('receivable-end-date').value;
                
                if (!startDate || !endDate) {
                    alert('Please fill both start and end dates');
                    return;
                }
                
                entry.startDate = startDate;
                entry.endDate = endDate;
            } else if (durationType === 'duration') {
                const years = parseInt(document.getElementById('receivable-years').value) || 0;
                const months = parseInt(document.getElementById('receivable-months').value) || 0;
                const days = parseInt(document.getElementById('receivable-days').value) || 0;
                
                if (years === 0 && months === 0 && days === 0) {
                    alert('Please fill at least one duration field');
                    return;
                }
                
                entry.startDate = new Date().toISOString().split('T')[0]; // Use today's date
                entry.years = years;
                entry.months = months;
                entry.days = days;
            } else if (durationType === 'fromstart') {
                const startDate = document.getElementById('receivable-from-start-date').value;
                
                if (!startDate) {
                    alert('Please fill the start date');
                    return;
                }
                
                entry.startDate = startDate;
                entry.endDate = new Date().toISOString().split('T')[0]; // Use today's date as end date
            }

            receivables.push(entry);
            updateReceivablesTable();
            
            // Clear form
            document.getElementById('receivable-name').value = '';
            document.getElementById('receivable-principal').value = '';
            document.getElementById('receivable-rate').value = '';
            document.getElementById('receivable-start-date').value = '';
            document.getElementById('receivable-end-date').value = '';
            document.getElementById('receivable-years').value = '';
            document.getElementById('receivable-months').value = '';
            document.getElementById('receivable-days').value = '';
            document.getElementById('receivable-from-start-date').value = '';
        }

        // Add payable entry
        function addPayable() {
            const name = document.getElementById('payable-name').value;
            const principal = parseFloat(document.getElementById('payable-principal').value);
            const rate = parseFloat(document.getElementById('payable-rate').value);
            const durationType = document.querySelector('input[name="payable-duration-type"]:checked').value;

            if (!name || !principal || !rate) {
                alert('Please fill all required fields');
                return;
            }

            let entry = {
                id: Date.now(),
                name,
                principal,
                rate,
                durationType
            };

            if (durationType === 'date') {
                const startDate = document.getElementById('payable-start-date').value;
                const endDate = document.getElementById('payable-end-date').value;
                
                if (!startDate || !endDate) {
                    alert('Please fill both start and end dates');
                    return;
                }
                
                entry.startDate = startDate;
                entry.endDate = endDate;
            } else if (durationType === 'duration') {
                const years = parseInt(document.getElementById('payable-years').value) || 0;
                const months = parseInt(document.getElementById('payable-months').value) || 0;
                const days = parseInt(document.getElementById('payable-days').value) || 0;
                
                if (years === 0 && months === 0 && days === 0) {
                    alert('Please fill at least one duration field');
                    return;
                }
                
                entry.startDate = new Date().toISOString().split('T')[0]; // Use today's date
                entry.years = years;
                entry.months = months;
                entry.days = days;
            } else if (durationType === 'fromstart') {
                const startDate = document.getElementById('payable-from-start-date').value;
                
                if (!startDate) {
                    alert('Please fill the start date');
                    return;
                }
                
                entry.startDate = startDate;
                entry.endDate = new Date().toISOString().split('T')[0]; // Use today's date as end date
            }

            payables.push(entry);
            updatePayablesTable();
            
            // Clear form
            document.getElementById('payable-name').value = '';
            document.getElementById('payable-principal').value = '';
            document.getElementById('payable-rate').value = '';
            document.getElementById('payable-start-date').value = '';
            document.getElementById('payable-end-date').value = '';
            document.getElementById('payable-years').value = '';
            document.getElementById('payable-months').value = '';
            document.getElementById('payable-days').value = '';
            document.getElementById('payable-from-start-date').value = '';
        }

        // Update receivables table
        function updateReceivablesTable() {
            const tbody = document.getElementById('receivables-table');
            tbody.innerHTML = '';

            let totalPrincipal = 0;
            let totalInterest = 0;
            let totalInterestTillDate = 0;
            let totalAmount = 0;

            receivables.forEach(entry => {
                let calc;
                if (entry.durationType === 'date' || entry.durationType === 'fromstart') {
                    calc = calculateCompoundInterest(entry.principal, entry.rate, entry.startDate, entry.endDate);
                } else {
                    calc = calculateCompoundInterest(entry.principal, entry.rate, entry.startDate, null, entry.years, entry.months, entry.days);
                }
                
                totalPrincipal += entry.principal;
                totalInterest += calc.interest;
                totalInterestTillDate += calc.interestTillDate;
                totalAmount += calc.total;

                // Format dates and duration
                const startDateFormatted = new Date(entry.startDate).toLocaleDateString('en-IN');
                let endDateFormatted = '';
                let durationFormatted = '';
                
                if (entry.durationType === 'date' || entry.durationType === 'fromstart') {
                    endDateFormatted = new Date(entry.endDate).toLocaleDateString('en-IN');
                    durationFormatted = formatDuration(entry.startDate, entry.endDate);
                } else {
                    endDateFormatted = '-';
                    durationFormatted = formatDuration(entry.startDate, null, entry.years, entry.months, entry.days);
                }

                const row = document.createElement('tr');
                row.className = 'hover:bg-green-50';
                row.innerHTML = `
                    <td class="border border-green-300 px-4 py-3">${entry.name}</td>
                    <td class="border border-green-300 px-4 py-3 text-right">₹${entry.principal.toLocaleString('en-IN', {maximumFractionDigits: 2})}</td>
                    <td class="border border-green-300 px-4 py-3 text-center">${startDateFormatted}</td>
                    <td class="border border-green-300 px-4 py-3 text-center">${endDateFormatted}</td>
                    <td class="border border-green-300 px-4 py-3 text-center">${durationFormatted}</td>
                    <td class="border border-green-300 px-4 py-3 text-right">₹${calc.interestTillDate.toLocaleString('en-IN', {maximumFractionDigits: 2})}</td>
                    <td class="border border-green-300 px-4 py-3 text-right font-semibold">₹${calc.total.toLocaleString('en-IN', {maximumFractionDigits: 2})}</td>
                    <td class="border border-green-300 px-4 py-3 text-center">
                        <button onclick="deleteReceivable(${entry.id})" class="bg-red-500 text-white px-2 py-1 rounded text-sm hover:bg-red-600">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            // Update totals
            document.getElementById('receivables-principal-total').textContent = `₹${totalPrincipal.toLocaleString('en-IN', {maximumFractionDigits: 2})}`;
            document.getElementById('receivables-interest-till-date-total').textContent = `₹${totalInterestTillDate.toLocaleString('en-IN', {maximumFractionDigits: 2})}`;
            document.getElementById('receivables-total-total').textContent = `₹${totalAmount.toLocaleString('en-IN', {maximumFractionDigits: 2})}`;
        }

        // Update payables table
        function updatePayablesTable() {
            const tbody = document.getElementById('payables-table');
            tbody.innerHTML = '';

            let totalPrincipal = 0;
            let totalInterest = 0;
            let totalInterestTillDate = 0;
            let totalAmount = 0;

            payables.forEach(entry => {
                let calc;
                if (entry.durationType === 'date' || entry.durationType === 'fromstart') {
                    calc = calculateCompoundInterest(entry.principal, entry.rate, entry.startDate, entry.endDate);
                } else {
                    calc = calculateCompoundInterest(entry.principal, entry.rate, entry.startDate, null, entry.years, entry.months, entry.days);
                }
                
                totalPrincipal += entry.principal;
                totalInterest += calc.interest;
                totalInterestTillDate += calc.interestTillDate;
                totalAmount += calc.total;

                // Format dates and duration
                const startDateFormatted = new Date(entry.startDate).toLocaleDateString('en-IN');
                let endDateFormatted = '';
                let durationFormatted = '';
                
                if (entry.durationType === 'date' || entry.durationType === 'fromstart') {
                    endDateFormatted = new Date(entry.endDate).toLocaleDateString('en-IN');
                    durationFormatted = formatDuration(entry.startDate, entry.endDate);
                } else {
                    endDateFormatted = '-';
                    durationFormatted = formatDuration(entry.startDate, null, entry.years, entry.months, entry.days);
                }

                const row = document.createElement('tr');
                row.className = 'hover:bg-red-50';
                row.innerHTML = `
                    <td class="border border-red-300 px-4 py-3">${entry.name}</td>
                    <td class="border border-red-300 px-4 py-3 text-right">₹${entry.principal.toLocaleString('en-IN', {maximumFractionDigits: 2})}</td>
                    <td class="border border-red-300 px-4 py-3 text-center">${startDateFormatted}</td>
                    <td class="border border-red-300 px-4 py-3 text-center">${endDateFormatted}</td>
                    <td class="border border-red-300 px-4 py-3 text-center">${durationFormatted}</td>
                    <td class="border border-red-300 px-4 py-3 text-right">₹${calc.interestTillDate.toLocaleString('en-IN', {maximumFractionDigits: 2})}</td>
                    <td class="border border-red-300 px-4 py-3 text-right font-semibold">₹${calc.total.toLocaleString('en-IN', {maximumFractionDigits: 2})}</td>
                    <td class="border border-red-300 px-4 py-3 text-center">
                        <button onclick="deletePayable(${entry.id})" class="bg-red-500 text-white px-2 py-1 rounded text-sm hover:bg-red-600">Delete</button>
                    </td>
                `;
                tbody.appendChild(row);
            });

            // Update totals
            document.getElementById('payables-principal-total').textContent = `₹${totalPrincipal.toLocaleString('en-IN', {maximumFractionDigits: 2})}`;
            document.getElementById('payables-interest-till-date-total').textContent = `₹${totalInterestTillDate.toLocaleString('en-IN', {maximumFractionDigits: 2})}`;
            document.getElementById('payables-total-total').textContent = `₹${totalAmount.toLocaleString('en-IN', {maximumFractionDigits: 2})}`;
        }

        // Delete functions
        function deleteReceivable(id) {
            receivables = receivables.filter(entry => entry.id !== id);
            updateReceivablesTable();
        }

        function deletePayable(id) {
            payables = payables.filter(entry => entry.id !== id);
            updatePayablesTable();
        }

        // Update dashboard
        function updateDashboard() {
            // Calculate receivables totals
            let receivablesTotalPrincipal = 0;
            let receivablesTotalInterest = 0;
            let receivablesTotalAmount = 0;

            receivables.forEach(entry => {
                let calc;
                if (entry.durationType === 'date' || entry.durationType === 'fromstart') {
                    calc = calculateCompoundInterest(entry.principal, entry.rate, entry.startDate, entry.endDate);
                } else {
                    calc = calculateCompoundInterest(entry.principal, entry.rate, entry.startDate, null, entry.years, entry.months, entry.days);
                }
                receivablesTotalPrincipal += entry.principal;
                receivablesTotalInterest += calc.interestTillDate;
                receivablesTotalAmount += calc.total;
            });

            // Calculate payables totals
            let payablesTotalPrincipal = 0;
            let payablesTotalInterest = 0;
            let payablesTotalAmount = 0;

            payables.forEach(entry => {
                let calc;
                if (entry.durationType === 'date' || entry.durationType === 'fromstart') {
                    calc = calculateCompoundInterest(entry.principal, entry.rate, entry.startDate, entry.endDate);
                } else {
                    calc = calculateCompoundInterest(entry.principal, entry.rate, entry.startDate, null, entry.years, entry.months, entry.days);
                }
                payablesTotalPrincipal += entry.principal;
                payablesTotalInterest += calc.interestTillDate;
                payablesTotalAmount += calc.total;
            });

            // Update dashboard display
            document.getElementById('dashboard-receivables-principal').textContent = `₹${receivablesTotalPrincipal.toLocaleString('en-IN', {maximumFractionDigits: 2})}`;
            document.getElementById('dashboard-receivables-interest').textContent = `₹${receivablesTotalInterest.toLocaleString('en-IN', {maximumFractionDigits: 2})}`;
            document.getElementById('dashboard-receivables-total').textContent = `₹${receivablesTotalAmount.toLocaleString('en-IN', {maximumFractionDigits: 2})}`;

            document.getElementById('dashboard-payables-principal').textContent = `₹${payablesTotalPrincipal.toLocaleString('en-IN', {maximumFractionDigits: 2})}`;
            document.getElementById('dashboard-payables-interest').textContent = `₹${payablesTotalInterest.toLocaleString('en-IN', {maximumFractionDigits: 2})}`;
            document.getElementById('dashboard-payables-total').textContent = `₹${payablesTotalAmount.toLocaleString('en-IN', {maximumFractionDigits: 2})}`;

            // Calculate net position
            const netPosition = receivablesTotalAmount - payablesTotalAmount;
            const netPositionElement = document.getElementById('net-position');
            const netPositionText = document.getElementById('net-position-text');

            netPositionElement.textContent = `₹${Math.abs(netPosition).toLocaleString('en-IN', {maximumFractionDigits: 2})}`;

            if (netPosition > 0) {
                netPositionElement.className = 'text-3xl font-bold mb-2 text-green-600';
                netPositionText.textContent = 'Net Amount to Receive';
            } else if (netPosition < 0) {
                netPositionElement.className = 'text-3xl font-bold mb-2 text-red-600';
                netPositionText.textContent = 'Net Amount to Pay';
            } else {
                netPositionElement.className = 'text-3xl font-bold mb-2 text-gray-600';
                netPositionText.textContent = 'Balanced Position';
            }
        }

        // Initialize with today's date
        document.addEventListener('DOMContentLoaded', function() {
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('receivable-start-date').value = today;
            document.getElementById('payable-start-date').value = today;
        });
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9654dc43c6dde14a',t:'MTc1MzU0MzAxMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
